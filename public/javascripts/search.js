const search_uri=origin+"/api/v1/search",addvideo_uri=origin+"/api/v1/video",search_uri_encode=encodeURI(search_uri),addvideo_encode=encodeURI(addvideo_uri);let resultlist=[];async function search(i){try{let d="";const e=await axios.post(search_uri_encode,{keyword:i});(resultlist=e.data).forEach(i=>{d+=`\n              <div class="video_result" id="${i.videoId}">\n              <span width="10%" style="margin-right:5px;" ><button class="addtoplaylist" onclick="addtoplay('${resultlist.indexOf(i)}')">Add</button></span>\n                    <span width="20%" style="margin-right:5px;"><img class="videoresult_img" width="80px" height="60px" src="https://i.ytimg.com/vi/${i.videoId}/default.jpg"></span>\n                    <span  height="100%" style="margin-right:5px;"> <span >${i.title}</span></span>\n              </div>\n              `}),$("#search_result").html(d)}catch(i){}}async function addtoplay(i){axios({method:"post",url:addvideo_encode,data:{video:resultlist[i]}}).then(i=>{$("#search").css("display","none"),$("#search_result").html(""),$("#search_type_input").val("")}).catch(()=>{window.alert("Bài này đã có rồi, thêm bài khác đi")})}$("#search_type_input").on("keyup",i=>{if(13===i.keyCode){search($("#search_type_input").val().toString())}}),document.getElementById("btn_search").addEventListener("click",()=>{search($("#search_type_input").val().toString())}),document.getElementById("search_close").addEventListener("click",()=>{document.getElementById("search").style.display="none"}),socket.on("addvideo",i=>{if(0==Array.isArray(i)){i.addby=i.addby.slice(0,i.addby.length-4)+"*";let d=`<div class="video_items" id="${i.videoId}">\n    <div class="box" >\n    <span id="img-playlist-video"><img height="75px" width="100px" src="https://i.ytimg.com/vi/${i.videoId}/default.jpg"></span>\n    <div>\n        <div id="title"><span >${i.title}</span></div>\n        <div id="addby"><span>added by ${i.addby}</span>\n    </div>\n    </div>\n    </div>\n    <div class="emotion">\n    <i id="like-${i.videoId}" class="far fa-thumbs-up like" onclick="likeVideo('${i.videoId}')"></i>\n    <span class="like_count" id="like_count-${i.videoId}">${i.like}</span>\n    <i id="dislike-${i.videoId}" class="far fa-thumbs-down dislike" onclick="dislikeVideo('${i.videoId}')"></i>\n    <span class="dislike_count" id="dislike_count-${i.videoId}">${i.dislike}</span>\n    </div>\n    </div>`;document.getElementById("videolist").innerHTML+=d}else{let d="";i.forEach(i=>{i.addby=i.addby.slice(0,i.addby.length-4)+"*",d+=`<div class="video_items" id="${i.videoId}">\n        <div class="box" >\n        <span id="img-playlist-video"><img height="75px" width="100px" src="https://i.ytimg.com/vi/${i.videoId}/default.jpg"></span>\n        <div>\n            <div id="title"><span >${i.title}</span></div>\n            <div id="addby"><span>added by ${i.addby}</span>\n        </div>\n        </div>\n        </div>\n        <div class="emotion">\n        <i id="like-${i.videoId}" class="far fa-thumbs-up like" onclick="likeVideo('${i.videoId}')"></i>\n        <span class="like_count" id="like_count-${i.videoId}">${i.like}</span>\n        <i id="dislike-${i.videoId}" class="far fa-thumbs-down dislike" onclick="dislikeVideo('${i.videoId}')"></i>\n        <span class="dislike_count" id="dislike_count-${i.videoId}">${i.dislike}</span>\n        </div>\n        </div>`}),document.getElementById("videolist").innerHTML+=d}});